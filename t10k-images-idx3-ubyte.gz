<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style>

/* Height needs to be 100% or else window will resize to size of content 
*/
html,body { 
    height: 100%;
}

body, ul, li {
        font-family:Arial, Helvetica, sans-serif;
        font-size:12px;
        color:#737373;
        margin:0;
        padding:0;
}
a:link, a:visited, a:active {
        text-decoration: underline;
        color:#015589;
}
a:hover {
        text-decoration: none;
        color:#51A8DE;
}
.content {
        padding: 20px 15px 15px 70px;
        margin: 0px auto 6px auto;
        border: #ebebeb solid 1px;
        width: 500px;
}
.blocking, .quotaing, .warning, .message {
        background-repeat:no-repeat;
        background-position: 9px 9px;
        }
.blocking {
        border-top: #D52B1E solid 2px;
        border-bottom: #D52B1E solid 2px;
        background-image:url(http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/ico_status_error.png);
        
}
.warning {
        border-top: #F0AB00 solid 2px;
        border-bottom: #F0AB00 solid 2px;
        background-image:url(http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/ico_status_warning.png);
}
.quotaing {
        border-top: #A4D3EE solid 2px;
        border-bottom: #A4D3EE solid 2px;
        background-image:url(http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/ico_status_quotaing.png);
}
.message {
        border-top: #0076C0 solid 2px;
        border-bottom: #0076C0 solid 2px;
        background-image:url(http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/ico_info.png);
}
.title {
        font-size: 24px;
        border-bottom: #ccc solid 1px;
        padding-bottom:15px;
        margin-bottom:15px;
}
.details li {
        list-style: none;
        padding: 6px 0;
}
.url {
        font-style:italic;
        font-weight: 700;
        width: 490px;
        height: 18px;
        display:block;
        overflow: hidden;
}
.combobox {
        font-size: 11px;
        color: #737373;
}
#textfield {
        width: 460px;
}
#button {
        font-size:11px;
}
.buttonHolder {
        padding-top: 6px;
}
.buttonHolder input {
    font-size:11px;
}
.footer {
        color: #ccc;
        font-size: 14px;
        width: 565px;
        margin: 0 auto;
        text-align:right;
}
ol.stepByStep {
        margin-left:-40px;
}
ol.stepByStep ol {
        margin-left:0 !important;
        display:none;
}
ol.stepByStep li.childActive ol, ol.stepByStep li.stepActive ol {
        display:block !important;
}
ol.stepByStep li {
        background-image:url(ico_wz_bullet.gif);
        background-repeat:no-repeat;
        font-weight:400;
        list-style:none;
        padding:2px 0 2px 20px;
}
ol.stepByStep li.stepPassed {
        background-image:url(ico_ok.gif) !important;
}
ol.stepByStep li.stepWarned {
        background-image:url(ico_concern.gif) !important;
}
ol.stepByStep li.stepFailed {
        background-image:url(ico_error.gif) !important;
}
ol.stepByStep li.stepActive {
        background-image:url(ico_busy.gif) !important;
        font-weight:700;
        color: #464646;
}
ol.stepByStep li.stepCurrent {
        background-image:url(ico_arrow.gif) !important;
        font-weight:700;
}
ol.stepByStep li.stepHelp {
        background-image:url(ico_help.gif) !important;
        font-weight:700;
}
.border01 {
        background-color:#fff;
}
.border02 {
        border:#dedede solid 1px;
        padding: 2px;
}
.barblue {
        background-color:#0095D8;
        height:16px;
        color: #fff;
}
.small {
        font-size: 10px;
}

.alertmessage {
    color: #EE3529;
    font-size: 12px;
    font-weight: 700;
}

.progressPercent {
        color: #ccc;
        display: block;
        font-weight: 700;
        margin-left: 220px;
        width: 40px;
}
</style>
    <title>Fichier en cours de contrôle : veuillez patienter</title>
</head>
<body>
<div align="center" id="logo">
    <div style='height: 70px; width: 500px;'></div>
</div>
<div class="content message">
    <div class="outerborder">
        <div class="alertHolder">
            <div class="alertIcon patience" id="alert_icon">
            </div>
            <div class="title" id="heading">
                Fichier en cours de contrôle : veuillez patienter
            </div>
            <div>
            <script language="JavaScript" type="text/javascript">
    var fileSize = -1;
    var displayThreatName =   'yes';
    var displayThreatSource = 'yes';
    var strDisplayLength = 60;
    var fields = ['progress_spin','progress','done','error','threat','pua','vscanderror','vscandtimeout','vscandnoscan','scanning', 'pending', 'tftblock', 'tftwarn'];
    var downloaded = 0;
    var downloadComplete = false;

    function patienceProgress(bytes_done, bytes_expect, percent_done,
                              transfer_rate, time_remaining) 
    {
        var now = new Date();
        downloaded = now.getTime();
        if (bytes_expect == "") {
            document.getElementById('txt_prog_spin').innerHTML = bytes_done + ' à ' + transfer_rate + '/sec';
            show('progress_spin');
        }
        else {
            document.getElementById('txt_prog').innerHTML = bytes_done + ' de ' + bytes_expect +
                                                            ' à ' + transfer_rate + '/sec &mdash; ' + 
                                                            time_remaining + ' restant';
            document.getElementById('prog_div_progress').style.width = percent_done + '%';
            document.getElementById('prog_div_percentage').innerHTML = percent_done + '%';
            show('progress');
        }
    }

    function setIcon(icon,state) {
        if (document.getElementById('img_' + icon)) {
            document.getElementById('img_' + icon).src = 'http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/icons/ico_' + state + '.gif';
        }
    }

    function setTitle(title) {
        document.getElementById('heading').innerHTML = title;
        document.title = title;
    }
    
    function patienceScanning() {
        setTitle('Fichier en cours de contrôle : veuillez patienter');
        setIcon('download','ok');
        setIcon('scan','busy');
        show('scanning');
    }
      
    function patiencePending(link) {
        setTitle('Analyse supplémentaire requise pour ce fichier');
        if (link == '#') { // for preview
                document.getElementById('lnk_sandbox_file').innerHTML = "download link";
        } 
        else {
                document.getElementById('lnk_sandbox_file').innerHTML = link;
                window.setTimeout(function() { location.href=link }, 30 * 1000);
        }
        document.getElementById('lnk_sandbox_file').href = link;
        setIcon('download','ok');
        setIcon('scan','caution');
        show('pending');
    }

    function patienceError(errorMessage) {
        downloadComplete = true;
        setTitle('Erreur fichier ');
        document.getElementById('txt_error').innerHTML=errorMessage;
        document.getElementById('error').style.display="";
        document.getElementById('alert_icon').className = 'alertIcon vscanderror';
        setIcon('scan','error');
        setIcon('ready','error');
        show('error');
    }

    function patienceKeyError(key) {
        downloadComplete = true;
        if (key!='downloadError') {
            setTitle('Requête bloquée : impossible de contrôler le fichier');
            document.getElementById('alert_icon').className = 'alertIcon vscanderror';
            setIcon('scan','error');
            setIcon('ready','error');
        } else {
            setTitle('Connexion perdue : impossible de télécharger le fichier                                                                           ');
        document.getElementById('alert_icon').className = 'alertIcon vscanderror';
            setIcon('download','error');
            setIcon('ready','error');

        }
        show(key);
    }

    function patiencePuaFound(puaname,threatsource) {
        downloadComplete = true;
        setTitle('Requête bloquée : application interdite');
        document.getElementById('alert_icon').className = 'alertIcon application';
        if (displayThreatName == 'yes') {
            document.getElementById('txt_pua').innerHTML += 
                "<span class='alertmessage'>Menace: " +
                shorten(puaname) + "</span><br />";
        }
        if (displayThreatSource == 'yes') {
            document.getElementById('txt_pua').innerHTML += 
                "<span class='alertmessage'>Source de la menace: " + 
                shorten(threatsource) + "</span>";
        }
        setIcon('scan','ok');
        setIcon('ready','error');
        show('pua');
    }

    function patienceThreatFound(virusname,threatsource) {
        downloadComplete = true;
        setTitle('Requête bloquée : le fichier contient du code malveillant');
        document.getElementById('alert_icon').className = 'alertIcon malware';
        if (displayThreatName == 'yes') {
            document.getElementById('txt_threat').innerHTML += 
                "<span class='alertmessage'>Menace: " + 
                shorten(virusname) + "</span><br />";
        }
        if (displayThreatSource == 'yes') {
            document.getElementById('txt_threat').innerHTML += 
                "<span class='alertmessage'>Source de la menace: " +
                shorten(threatsource) + "</span>";
        }
        setIcon('scan','ok');
        setIcon('ready','error');
        show('threat');
    }
    
    function patienceTFTBlockFound(tfttype,threatsource) {
        downloadComplete = true;
        setTitle('Requête bloquée : type de fichiers interdit');
        document.getElementById('alert_icon').className = 'alertIcon malware';
        if (displayThreatName == 'yes') {
            document.getElementById('txt_tftblock').innerHTML += 
                "<span class='alertmessage'>Menace: " + 
                shorten(tfttype) + "</span><br />";
        }
        if (displayThreatSource == 'yes') {
            document.getElementById('txt_tftblock').innerHTML += 
                "<span class='alertmessage'>Source de la menace: " +
                shorten(threatsource) + "</span>";
        }
        setIcon('scan','ok');
        setIcon('ready','error');
        show('tftblock');
    }

    function patienceTFTWarnFound(tfttype, threatsource, link) {
        downloadComplete = true;
        setTitle('Avertissement : fichier douteux');
        document.getElementById('alert_icon').className = 'alertIcon malware';
        if (displayThreatName == 'yes') {
            document.getElementById('txt_tftwarn').innerHTML +=
                "<span class='alertmessage'>Motif: " +
                shorten(tfttype) + "</span><br />";
        }
        if (displayThreatSource == 'yes') {
            document.getElementById('txt_tftwarn').innerHTML +=
                "<span class='alertmessage'>Site: " +
                shorten(threatsource) + "</span>";
        }
        document.getElementById('lnk_file_warn').onclick = function() { window.open(link); };
        setIcon('scan','ok');
        setIcon('ready','caution');
        show('tftwarn');
    }

    function patienceDone(link) {
        downloadComplete = true;
        setTitle('Le fichier est prêt ');
        document.getElementById('lnk_file').onclick = function() { window.open(link); };
        setIcon('download','ok');
        setIcon('scan','ok');
        setIcon('ready','ok');
        show('done');
    }
    
    function show(field) {
        for (var i=0, n = fields.length; i < n; i++) {
            document.getElementById(fields[i]).style.display="none";
        }
        document.getElementById(field).style.display="";
    }

    function stallCheck() {
        var now = new Date()
        if (now.getTime() - downloaded > 4800) {
            document.getElementById('txt_stalled').innerHTML = 'Aucune réponse du serveur pendant cinq secondes - nouvel essai...';	
        } else {
            document.getElementById('txt_stalled').innerHTML = '';	
        }
        if (!downloadComplete) window.setTimeout('stallCheck()',5000);
    }

    function init() {
        if (self != top) {
            top.location = self.location;
            return;
        }
        var h = document.body.clientHeight;
        var w = document.body.clientWidth;
        if (h < 300 || w < 500) {
            window.resizeTo(600, 480);
            window.focus();
        }
        window.setTimeout('stallCheck()',5000);
    }

    function shorten(str) {
        if (str.length > strDisplayLength) {
            return str.substr(0, strDisplayLength) + "...";
        }
        return str;
    }

</script>

<div style="display:none;visibility:hidden;" id="selectedMenuItem">UsrViewPatience</div>
    <div class="boxed" style="margin-bottom:10px;">
        <table border="0">
            <tr>
                <td width="20"><img id="img_download" src="http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/icons/ico_arrow.gif" alt=">" width="16" height="16" /></td>
                <td class="body">Téléchargement en cours du fichier demandé</td>
            </tr>
            <tr>
                <td><img id="img_scan" src="http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/icons/ico_default.gif" alt=">" /></td>
                <td class="body">Contrôle en cours du fichier téléchargé</td>
            </tr>
            <tr>
                <td><img id="img_ready" src="http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/icons/ico_default.gif" alt=">" /></td>
                <td class="body">Le fichier est prêt</td>
            </tr>
        </table>
    </div>

<!--show hide div layer containing steps -->
<div id="progress_spin" style="display:none" >
    <img src="http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/processLight.gif" alt="" /><br />
    <div class="bodytiny" id="txt_prog_spin" >&nbsp;</div>
</div>

<!-- STEP 1: Downloading your requested file -->
<div id="progress">
    <div id="alertDownload">Le fichier demandé est en cours de téléchargement et de contrôle d&#039;éventuelles menaces à la sécurité.<br />
        <div class="border01">
            <div class="border02">
                <div class="border01">
                    <div id="prog_div_progress" width="0%" class="barblue">
                        <div id="prog_div_percentage" class="progressPercent">&nbsp;</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="small" id="txt_prog" >&nbsp;</div>
    <div class="small" id="txt_stalled" >&nbsp;</div>
</div>

<!-- STEP 2: Scanning downloaded file -->
<div id="scanning" style="display:none" >
    <!--<img src="http://fvlproxy.fvl.sea.css.fujitsu.com/resources/images/processLight.gif" alt="" /><br />-->
    Le téléchargement et l’analyse de sécurité du fichier demandé sont en cours. S&#039;il est considéré sain, un lien vers ce fichier sera affiché ci-dessous.</div>

<!--         Consulting Sophos Sandbox -->
<div id="pending" style="display:none" >Du contenu suspect a été détecté dans le fichier demandé. Le fichier a été envoyé à Sophos Sandstorm qui va procéder à une analyse supplémentaire. Cette opération peut prendre quelques minutes.<p></p>Si le fichier est considéré sain suite à l&#039;analyse, vous pourrez le télécharger à l&#039;emplacement indiqué ci-dessous :        <p></p><a id="lnk_sandbox_file"></a>
</div>

<!-- STEP 4: File is ready (or error) -->
<div id="done" style="display:none;" >Le fichier a été contrôlé et confirmé sain.    <div class="buttonHolder" style="margin-top:5px;">
        <input type="button" id="lnk_file" value='Cliquez ici pour récupérer le fichier'/>
    </div>
</div>

<div id="error" style="display:none">
    <p id="txt_error" class="body">Le fichier que vous avez demandé contient une erreur et n'a pas pu être contrôlé.</p>
</div>
<div id="threat" style="display:none">
    <p id="txt_threat" class="body"></p>
    <p id="txt_threatinfo" class="body">Le fichier que vous avez demandé contient du code malveillant. Son téléchargement a été bloqué.</p>
</div>
<div id="tftblock" style="display:none">
    <p id="txt_tftblock" class="body"></p>
    <p id="txt_tftblockinfo" class="body">La stratégie d’accès à Internet de votre entreprise restreint les téléchargements de ce type de fichier.</p>
</div>
<div id="tftwarn" style="display:none">
    <p id="txt_tftwarn" class="body"></p>
    <p id="txt_tftwarninfo" class="body">Il semble qu&#039;avec la politique d&#039;accès Internet de votre entreprise, vous ne pouvez pas télécharger ce type de fichier. Vous pouvez télécharger ce fichier à votre propre discrétion.</p>
    <div class="buttonHolder" style="margin-top:5px;">
        <input type="button" id="lnk_file_warn" value='Cliquez ici pour récupérer le fichier'/>
    </div>
</div>
<div  id="pua" style="display:none">
    <p id="txt_pua" class="body"></p>
    <p id="txt_puainfo" class="body">L&#039;accès à ce fichier est interdit car il représente un risque de sécurité potentiel.</p>
</div>
<div  id="vscanderror" style="display:none">
    <p id="txt_vscanderror" class="body"></p>
    <p id="txt_vscanderrorinfo" class="body">Le fichier demandé n&#039;a pas pu être contrôlé par Sophos Anti-Virus. Ceci signifie qu&#039;il est soit crypté, soit qu&#039;il contient des erreurs empêchant de le contrôler totalement. Par conséquent, le téléchargement du fichier a été bloqué.</p>
 </div>
<div  id="vscandtimeout" style="display:none">
    <p id="txt_vscandtimeout" class="body"></p>
    <p id="txt_vscandtimeoutinfo" class="body">﻿Le fichier que vous avez demandé était d&#039;une taille trop grande pour faire l&#039;objet d&#039;une recherche complète des menaces. Veuillez contacter votre administrateur système pour pouvoir accéder à ce fichier.</p>
</div>
<div  id="vscandnoscan" style="display:none">
    <p id="txt_vscandnoscan" class="body"></p>
    <p id="txt_vscandnoscaninfo" class="body">﻿Le fichier a été téléchargé mais n&#039;a pas pu faire l&#039;objet d&#039;une recherche des menaces.</p>
</div>
<div  id="downloadError" style="display:none">
    <p id="txt_downloadError" class="body"></p>
    <p id="txt_downloadError" class="body">Le fichier n&#039;a pas pu être téléchargé en raison de la perte de connexion avec le serveur.</p>
</div>

<script>
    init();
    </script>

            </div>
        </div>
    </div>
</div>
<div class="footer">
    sophos <strong>web protection</strong>
</div>

<script>patienceProgress('253 kB','1.6 MB',16,' 51 kB','00:00:26');</script>
<script>patienceProgress('544 kB','1.6 MB',34,' 68 kB','00:00:15');</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceProgress('889 kB','1.6 MB',55,' 81 kB','00:00:08');</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceProgress('1.1 MB','1.6 MB',69,' 80 kB','00:00:06');</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceProgress('1.3 MB','1.6 MB',85,' 81 kB','00:00:03');</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceProgress('1.5 MB','1.6 MB',93,' 75 kB','00:00:01');</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceScanning();</script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>patienceDone("http://fvlproxy.fvl.sea.css.fujitsu.com/cgi-bin/patience.cgi?id=3d144915-bf0c-46ed-a65f-3c9823482b5e");</script></body></html>
